Bits â† '0'-ËœâŠ¢
Base10 â‡ 10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½
Number â‡ Base10 -âŸœ'0'
Ints â‡ {NumberÂ¨((Â¯1+âŠ¢Ã—Â·+`Â»âŠ¸<)ğ•©âˆŠ'0'+â†•10)âŠ”ğ•©}


Parse â† { (Base10âˆ˜BitsÂ¨)Â¨ ','âŠ¸SplitÂ¨ 1â€¿0â€¿1/' ' Split ğ•© }

l â† {<Ë˜2â€¿2â¥Šğ•©}Â¨ IntsÂ¨ â€¢FLines "sample5.in"
vs â† {sâ€¿e: s<âŠ¸+(<Ã—e-s)Ã—â†•1+âŒˆÂ´|e-s}Â¨ l
# For each take the start and end
# âŒˆÂ´|e-s              - Maximum of the absolute value of coordinates of end - start -- biggest change in x or y
# â†•1+âŒˆÂ´|e-s           - Range from 0 to above
# (<Ã—e-s)             - Enclose the sign of e-s -- The slope of the line wrt time
# (<Ã—e-s)Ã—â†•1+âŒˆÂ´|e-s   - coordinates in the line as a vector from origin
# s<âŠ¸+(above)        - enclose start and add to each point to get line as vector from start

{â€¢Show +Â´1=âŠ’âˆ¾ğ•©}Â¨ vsâ‹ˆËœvs/Ëœ(âˆ¨Â´=Â´)Â¨l
# vsâ‹ˆËœvs/Ëœ(âˆ¨Â´=Â´)Â¨l
# (âˆ¨Â´=Â´)Â¨l - mask that determines if x1=x2 or y1=y2 (i.e. a vertical/horizontal line)
# vsâ‹ˆËœvs/Ëœmask = (mask/vs) â‹ˆ vs (i.e problem 1 data or problem 2 data)
# +Â´1=âŠ’âˆ¾ğ•©
#  âˆ¾ğ•©    - Join all vertices together
#  âŠ’âˆ¾ğ•©   - Return the number of times the major cell (vertex) has appears before this index
#  +Â´1=âŠ’âˆ¾x - If something has appeared once already than it's appeared â‰¥2 times, so add these up (don't count additional times)


# OnLine â† {âŸ¨x1, y1âŸ©â€¿âŸ¨x2, y2âŸ©ğ•ŠâŸ¨x, yâŸ©:
#         {
#             y1=y2 ? (y1=y)âˆ§0â‰¥Ã—Â´âŸ¨x1, x2âŸ©-x;
#             x1=x2 ? (x1=x)âˆ§0â‰¥Ã—Â´âŸ¨y1, y2âŸ©-y;
#             0
#         }
# }

# biggest â† âŒˆÂ´â¥Š>l
# â€¢Show +Â´â¥Š2â‰¤+Ë(<Ë˜l) OnLineâŒœ â¥Šâ‹ˆâŒœËœâ†•1+biggest